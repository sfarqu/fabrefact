
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
 <channel>
   <title>devlog on Fabrefact</title>
   <link>https://blog.fabrefact.ca/categories/devlog/</link>
   <description>Recent content in devlog on Fabrefact</description>
   <generator>Hugo -- gohugo.io</generator>
   <language>en-us</language>
   <copyright>&amp;copy; 2019 Sara Farquharson</copyright>
   <lastBuildDate>Thu, 11 Feb 2021 23:59:00 -0700</lastBuildDate>
   
       <atom:link href="https://blog.fabrefact.ca/categories/devlog/index.xml" rel="self" type="application/rss+xml" />
   
   
   
   
     <item>
       <title>Virtual Party Space Devlog #23: Connection interrupted</title>
       <link>https://blog.fabrefact.ca/posts/virtual-party-space-devlog-23/</link>
       <pubDate>Thu, 11 Feb 2021 23:59:00 -0700</pubDate>
       
       <guid>https://blog.fabrefact.ca/posts/virtual-party-space-devlog-23/</guid>
       <description>&lt;p&gt;Spent a solid week tweaking and testing my AWS setup, only to discover mysterious connection issues that would cause all players to get booted off the server if more than a few people connected at a time.&lt;/p&gt;
&lt;p&gt;At only 2 weeks before the event was originally scheduled, there&amp;rsquo;s no realistic way to fix this issue, actually finish the interface, and hold the event as planned. Putting this project on hold for now, mystery connection issue still unresolved.&lt;/p&gt;
&lt;h1 id=&#34;log&#34;&gt;Log&lt;/h1&gt;
&lt;h3 id=&#34;thursday-february-4&#34;&gt;Thursday, February 4&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;turns out scripts are constantly scraping my app looking for admin pages or vulns!
&lt;ul&gt;
&lt;li&gt;for some reason source IPs are not preserved though&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://aws.amazon.com/premiumsupport/knowledge-center/elb-capture-client-ip-addresses/&#34;&gt;https://aws.amazon.com/premiumsupport/knowledge-center/elb-capture-client-ip-addresses/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;finally put code on github in case something happens to my computer&lt;/li&gt;
&lt;li&gt;looks like JVB has a memory leak? memory usage increases permanently after every CPU spike
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/jitsi/jitsi-videobridge/issues/1396&#34;&gt;https://github.com/jitsi/jitsi-videobridge/issues/1396&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;friday-february-5&#34;&gt;Friday, February 5&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;looked at malleus, going to take some Java work to try to make it test my frontend&lt;/li&gt;
&lt;li&gt;manual testing by opening a bunch of windows first
&lt;ul&gt;
&lt;li&gt;default config starts dropping connections at &amp;gt;4 people in conference&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Can keep a permanent loadbalancer while killing the rest of the stack
&lt;ul&gt;
&lt;li&gt;Use &lt;code&gt;x-aws-loadbalancer&lt;/code&gt; as a top-level element in your Compose file to set the ARN of an existing LoadBalancer.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;sunday-february-7&#34;&gt;Sunday, February 7&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;trying out new cloudformation configs
&lt;ul&gt;
&lt;li&gt;permanent load balancer, set using &lt;code&gt;x-aws-loadbalancer&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;took a long time for this to stabilize after bringing up, but seems to work now&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;setting HTTP2Preferred on TLS endpoint
&lt;ul&gt;
&lt;li&gt;broke everything, probably because of the hack to make non-SSL port 443 in nginx.&lt;/li&gt;
&lt;li&gt;need to figure out how to re-encrypt traffic to instance while still keeping ELB certificate&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;greater capacity for JVB server (8Gb RAM)
&lt;ul&gt;
&lt;li&gt;problem seems to be CPU, not RAM, but 8Gb is recommended for high load&lt;/li&gt;
&lt;li&gt;can&amp;rsquo;t set both CPU and memory, so going with RAM&lt;/li&gt;
&lt;li&gt;setting 8Gb forces 1vCPU, rather than default of .25 or .5&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://aws.amazon.com/premiumsupport/knowledge-center/ecs-fargate-high-cpu-utilization/&#34;&gt;https://aws.amazon.com/premiumsupport/knowledge-center/ecs-fargate-high-cpu-utilization/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;oh-no-a-big-problem&#34;&gt;Oh no a big problem&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Can&amp;rsquo;t seem to stably handle more than 4 concurrent users
&lt;ul&gt;
&lt;li&gt;jicofo reports that users are sending &amp;ldquo;MemberLeft&amp;rdquo; messages &amp;ldquo;Chat room event ChatRoomMemberPresenceChangeEvent&amp;rdquo;&lt;/li&gt;
&lt;li&gt;JS: Lots of &amp;ldquo;Ping timeout&amp;rdquo; from modules/xmpp/strophe.ping.js&lt;/li&gt;
&lt;li&gt;JS: Often gets stuck in &amp;ldquo;Bridge Channel send: no opened channel.&amp;rdquo; from modules/RTC/BridgeChannel.js (groups of 4 every 10s)
THEORY: nginx connections get saturated, leading to timeouts
&lt;ul&gt;
&lt;li&gt;default configs for Fargate task of .25 vCPU probably means work gets blocked if co-sharing&lt;/li&gt;
&lt;li&gt;tried creating a second task instance, but HTTPS traffic was never routed to it (WHY?)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;turning on &lt;a href=&#34;https://docs.aws.amazon.com/elasticloadbalancing/latest/network/load-balancer-access-logs.html&#34;&gt;access logs for ELB&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;tuesday-february-9&#34;&gt;Tuesday, February 9&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;character creator
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://www.dropzonejs.com/#usage&#34;&gt;https://www.dropzonejs.com/#usage&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://camanjs.com/&#34;&gt;http://camanjs.com/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;no good existing dollmaker open source projects&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;thursday-february-11&#34;&gt;Thursday, February 11&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;trying to figure out why connections dropping
&lt;ul&gt;
&lt;li&gt;testing locally
&lt;ul&gt;
&lt;li&gt;local build requires local environment variables to be built into JS project
&lt;ul&gt;
&lt;li&gt;add &lt;code&gt;path&lt;/code&gt; parameter to &lt;code&gt;Dotenv&lt;/code&gt; instantiation in &lt;code&gt;webpack.config&lt;/code&gt; to set to &lt;code&gt;.env.local&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;rebuild docker container for local tag &lt;code&gt;docker- build -t sfarqu/party-app:latest .&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;use docker-compose and local .env file &lt;code&gt;docker--compose --env-file .env.local up -d&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;5 connections locally seem to run fine, but tons of &amp;ldquo;Bridge Channel send: no opened channel.&amp;rdquo; errors
&lt;ul&gt;
&lt;li&gt;probably related to &amp;ldquo;Firefox canâ€™t establish a connection to the server at wss://meet.chicazul.com/colibri-ws/172.25.0.5/&amp;hellip;&amp;rdquo;&lt;/li&gt;
&lt;li&gt;does this mean that app is failing to set up videobridge connections and is instead using P2P?
&lt;ul&gt;
&lt;li&gt;that could explain why local is way more stable that AWS version&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;NEW INVESTIGATION TRACK: figure out why colibri websocket connections are failing&lt;/li&gt;
&lt;li&gt;don&amp;rsquo;t recall consistently seeing that error in AWS version, so may be red herring&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Investigating &amp;ldquo;connection interrupted&amp;rdquo; error in &lt;code&gt;lib-jitsi-meet&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;sometimes it was a different error, so it&amp;rsquo;s not just this thing, but it was an issue&lt;/li&gt;
&lt;li&gt;both P2P errors and JVB errors throw the same interruption message.&lt;/li&gt;
&lt;li&gt;in theory interruptions should be recoverable&amp;hellip;how?&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;about-this-series&#34;&gt;About this series&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;Back in mid-December I started an ambitious project to create a custom platform for a virtual birthday party in February. I kept notes on my progress, both for personal reference and to turn into a series of blog posts. It quickly became apparent that I did not have time to both &lt;em&gt;do the project&lt;/em&gt; and &lt;em&gt;blog about the project&lt;/em&gt;. I have retroactively decided to post my raw notes as a dev log.&lt;/p&gt;
&lt;/blockquote&gt;</description>
     </item>
   
     <item>
       <title>Virtual Party Space Devlog #22: Amazon Certificates Manager</title>
       <link>https://blog.fabrefact.ca/posts/virtual-party-space-devlog-22/</link>
       <pubDate>Wed, 03 Feb 2021 23:59:00 -0700</pubDate>
       
       <guid>https://blog.fabrefact.ca/posts/virtual-party-space-devlog-22/</guid>
       <description>&lt;p&gt;In the past couple days I threw away all that work with Let&amp;rsquo;s Encrypt to use Amazon Certificates Manager instead.&lt;/p&gt;
&lt;h1 id=&#34;log&#34;&gt;Log&lt;/h1&gt;
&lt;h2 id=&#34;tuesday-february-2&#34;&gt;Tuesday, February 2&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Note for future: &lt;a href=&#34;https://aws.amazon.com/fr/blogs/containers/how-amazon-ecs-manages-cpu-and-memory-resources/&#34;&gt;CPU and memory in ECS&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Error &amp;ldquo;The VPC &lt;!-- raw HTML omitted --&gt; in region &lt;!-- raw HTML omitted --&gt; has already been associated with the hosted zone &lt;!-- raw HTML omitted --&gt; with the same domain name&amp;rdquo;
&lt;ul&gt;
&lt;li&gt;Deleted VPC to fix this DO NOT DO THIS, need to have a default VPC to do anything&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;verified that ELB changes every time I delete the stack, so will have to keep updating CNAME record
&lt;ul&gt;
&lt;li&gt;unless I can figure out how to retain ELB without breaking create&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;updated health check by adding overlays, but have to delete whole stack for every change&lt;/li&gt;
&lt;li&gt;had to expose port 8080 which I don&amp;rsquo;t love, but at least it works&lt;/li&gt;
&lt;li&gt;tried out Amazon Certificate Manager to request a certificate for my domain, and that seems to have worked
&lt;ul&gt;
&lt;li&gt;think it should automatically use it for load balancer? Need to wait for domain to propagate to check&lt;/li&gt;
&lt;li&gt;wasted all that time learning Let&amp;rsquo;s Encrypt and didn&amp;rsquo;t need it, but at least I learned something&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;wednesday-february-3&#34;&gt;Wednesday, February 3&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;How to make drastic changes to cloudformation template: &lt;a href=&#34;https://aws.amazon.com/premiumsupport/knowledge-center/failing-stack-updates-deleted/&#34;&gt;delete resource and manually recreate&lt;/a&gt; so update will work&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;acm-certificates&#34;&gt;ACM certificates&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;need to add certificate to a listener on port 443
&lt;ul&gt;
&lt;li&gt;change type from TCP to TLS&lt;/li&gt;
&lt;li&gt;leave other settings as default I guess&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;PROBLEM: this causes &amp;ldquo;http request to https port&amp;rdquo; error
&lt;ul&gt;
&lt;li&gt;ELB terminates HTTPS and sends HTTP request to web server - need to tell nginx to stand down&lt;/li&gt;
&lt;li&gt;SOLUTION:
&lt;ul&gt;
&lt;li&gt;remove &lt;code&gt;ssl http2&lt;/code&gt; from nginx &lt;code&gt;listen 443&lt;/code&gt; directives (this means probably want to turn on ALPN HTTP2 service on ELB listener)
&lt;ul&gt;
&lt;li&gt;if you get rid of &lt;code&gt;ssl&lt;/code&gt; but not &lt;code&gt;http2&lt;/code&gt; server will still &lt;em&gt;run&lt;/em&gt; but only return garbage - HTTP2 is SSL-only&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;remove all other ssl directives (conveniently packaged in &lt;code&gt;ssl.conf&lt;/code&gt;)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;about-this-series&#34;&gt;About this series&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;Back in mid-December I started an ambitious project to create a custom platform for a virtual birthday party in February. I kept notes on my progress, both for personal reference and to turn into a series of blog posts. It quickly became apparent that I did not have time to both &lt;em&gt;do the project&lt;/em&gt; and &lt;em&gt;blog about the project&lt;/em&gt;. I have retroactively decided to post my raw notes as a dev log.&lt;/p&gt;
&lt;/blockquote&gt;</description>
     </item>
   
     <item>
       <title>Virtual Party Space Devlog #21: Let&#39;s Encrypt</title>
       <link>https://blog.fabrefact.ca/posts/virtual-party-space-devlog-21/</link>
       <pubDate>Mon, 01 Feb 2021 23:59:00 -0700</pubDate>
       
       <guid>https://blog.fabrefact.ca/posts/virtual-party-space-devlog-21/</guid>
       <description>&lt;p&gt;Today I learned how to get an SSL certificate with Let&amp;rsquo;s Encrypt, and discovered a lot about health checks.&lt;/p&gt;
&lt;h1 id=&#34;log&#34;&gt;Log&lt;/h1&gt;
&lt;h3 id=&#34;lets-encrypt-go&#34;&gt;LETS ENCRYPT GO&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;reason why docker-jitsi-meet uses standalone mode may be that if container is directly exposed to internet, standalone server might be live fast enough for LE call to succeed.&lt;/li&gt;
&lt;li&gt;in Fargate, container doesn&amp;rsquo;t last long enough to pass health check and become valid recipient for HTTP request forwarded from load balancer&lt;/li&gt;
&lt;li&gt;need a way to get a live server that responds to HTTP requests
&lt;ul&gt;
&lt;li&gt;stood up EC2 instance, installed acme.sh &amp;amp; nginx, and attached it as a target for load balancer SUCCESS!
&lt;ul&gt;
&lt;li&gt;scp keys back to my computer, hack is store them in config directory baked into docker image (since only need them for 30 days)&lt;/li&gt;
&lt;li&gt;modified server init script to install acme.sh keys to nginx on start, and not try to get keys.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;keys don&amp;rsquo;t work!
&lt;ul&gt;
&lt;li&gt;created keys with &amp;ndash;staging enabled to allow more retries&lt;/li&gt;
&lt;li&gt;tried to recreate without staging, but got &amp;ldquo;keys are fine, didn&amp;rsquo;t recreate&amp;rdquo; from real server
&lt;ul&gt;
&lt;li&gt;guess have to use &amp;ndash;force once you&amp;rsquo;re sure your code works&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;for long-term fix, probably need a &lt;a href=&#34;https://autoize.com/automating-lets-encrypt-https-behind-a-load-balancer/&#34;&gt;dedicated cert-renewal server&lt;/a&gt;?
&lt;ul&gt;
&lt;li&gt;how does load balancer know to direct traffic to port 80 on a different type of server?
&lt;ul&gt;
&lt;li&gt;docker compose ECS group only lets you have one service with same port open, unsure how to manage&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;testing-with-2-people&#34;&gt;Testing with 2 people&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;conference seems to die every 5 minutes, is JVB rebooting?
&lt;ul&gt;
&lt;li&gt;turns out yes, health checks for ports (10000/4443) are &amp;ldquo;failing&amp;rdquo; so Fargate kills the container&lt;/li&gt;
&lt;li&gt;can I update health check?
&lt;ul&gt;
&lt;li&gt;not really, can&amp;rsquo;t change timeout or interval (and probably wouldn&amp;rsquo;t help, because UDP port isn&amp;rsquo;t going to respond to health check)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;JVB has &lt;a href=&#34;https://github.com/jitsi/jitsi-videobridge/blob/master/doc/health-checks.md&#34;&gt;health check endpoint&lt;/a&gt;!&lt;/li&gt;
&lt;li&gt;docker-compose has &lt;code&gt;healthcheck&lt;/code&gt; option, maybe this is what lets you make a custom health check?&lt;/li&gt;
&lt;li&gt;apparently you can&amp;rsquo;t update the health check for a TargetGroup
&lt;ul&gt;
&lt;li&gt;deleting the target group broke updates for the Cloudformation Stack&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;about-this-series&#34;&gt;About this series&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;Back in mid-December I started an ambitious project to create a custom platform for a virtual birthday party in February. I kept notes on my progress, both for personal reference and to turn into a series of blog posts. It quickly became apparent that I did not have time to both &lt;em&gt;do the project&lt;/em&gt; and &lt;em&gt;blog about the project&lt;/em&gt;. I have retroactively decided to post my raw notes as a dev log.&lt;/p&gt;
&lt;/blockquote&gt;</description>
     </item>
   
     <item>
       <title>Virtual Party Space Devlog #20: Docker registries</title>
       <link>https://blog.fabrefact.ca/posts/virtual-party-space-devlog-20/</link>
       <pubDate>Sun, 31 Jan 2021 23:59:00 -0700</pubDate>
       
       <guid>https://blog.fabrefact.ca/posts/virtual-party-space-devlog-20/</guid>
       <description>&lt;p&gt;Today I dug deeper into how Docker works to resolve some error messages, and then started learning about Let&amp;rsquo;s Encrypt.&lt;/p&gt;
&lt;h1 id=&#34;log&#34;&gt;Log&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;struggled with running &lt;code&gt;docker compose up&lt;/code&gt; due to &amp;ldquo;authentication failed&amp;rdquo; message, so I took a multiple-hour detour into how docker registries work
&lt;ul&gt;
&lt;li&gt;NOTE: when you get this error it probably means your image doesn&amp;rsquo;t exist in an &amp;ldquo;acceptable&amp;rdquo; registry (doesn&amp;rsquo;t matter if you can see it locally)&lt;/li&gt;
&lt;li&gt;existing images were possibly resolving to wrong hash from docker.io, maybe deploying wrong version?&lt;/li&gt;
&lt;li&gt;solution: create ECR registry, add all locally built images to it
&lt;ul&gt;
&lt;li&gt;can also do &lt;a href=&#34;https://docs.docker.com/registry/introduction/&#34;&gt;local registry&lt;/a&gt; but for this ECR makes sense&lt;/li&gt;
&lt;li&gt;docker has &lt;a href=&#34;https://github.com/awslabs/amazon-ecr-credential-helper#Configuration&#34;&gt;ecr credentials helper&lt;/a&gt; built in
&lt;ul&gt;
&lt;li&gt;set &lt;code&gt;~/.docker/config.json&lt;/code&gt; &amp;ldquo;credsStore&amp;rdquo; to &amp;ldquo;ecr-login&amp;rdquo;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://docs.docker.com/engine/reference/commandline/push/&#34;&gt;https://docs.docker.com/engine/reference/commandline/push/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;new flow: &lt;code&gt;docker build -t &amp;lt;name&amp;gt;:&amp;lt;tag&amp;gt; -t &amp;lt;remote-name&amp;gt;:&amp;lt;remote-tag&amp;gt; .&lt;/code&gt; &amp;amp;&amp;amp; &lt;code&gt;docker push&lt;/code&gt; &amp;amp;&amp;amp; &lt;code&gt;docker compose up --file docker-compose-aws.yml --context &amp;lt;ecscontext&amp;gt;&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;use &lt;code&gt;docker rmi&lt;/code&gt; to remove unnecessary images&lt;/li&gt;
&lt;li&gt;docker &amp;ldquo;Pool overlaps with other one on this address space&amp;rdquo; error or being unable to delete things in Docker Desktop indicates you have ghost docker networks, need to prune&lt;/li&gt;
&lt;li&gt;PARTY NOW RUNNING!&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.cynkra.com/2020/11/02/jitsi-load-balanced/index.html&#34;&gt;load balancing ref&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;lets-encrypt-time&#34;&gt;Let&amp;rsquo;s Encrypt time!&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;enabled flag in environment variables, quickly got an API timeout&lt;/li&gt;
&lt;li&gt;ECS by default has a &amp;ldquo;Desired count&amp;rdquo; of 1, so containers keep spawning and re-running the erroneous encrypt script
&lt;ul&gt;
&lt;li&gt;to prevent this, update the service to &amp;ldquo;number of tasks&amp;rdquo; 0. Will automatically reset on next Cloudformation update&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;jitsi web host uses &lt;a href=&#34;https://github.com/acmesh-official/acme.sh&#34;&gt;acme.sh&lt;/a&gt; to do lets encrypt keys in init script&lt;/li&gt;
&lt;li&gt;tried alternatives to standalone mode&amp;hellip;nginx/webroot, still always get failure
&lt;ul&gt;
&lt;li&gt;lets encrypt requires healthy server responding on port 80&lt;/li&gt;
&lt;li&gt;problem is this init script also creates the nginx config files, and if LETS_ENCRYPT flag is true, nginx can&amp;rsquo;t start without keys. Chicken &amp;amp; egg&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;about-this-series&#34;&gt;About this series&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;Back in mid-December I started an ambitious project to create a custom platform for a virtual birthday party in February. I kept notes on my progress, both for personal reference and to turn into a series of blog posts. It quickly became apparent that I did not have time to both &lt;em&gt;do the project&lt;/em&gt; and &lt;em&gt;blog about the project&lt;/em&gt;. I have retroactively decided to post my raw notes as a dev log.&lt;/p&gt;
&lt;/blockquote&gt;</description>
     </item>
   
     <item>
       <title>Virtual Party Space Devlog #19: Containerizing an app</title>
       <link>https://blog.fabrefact.ca/posts/virtual-party-space-devlog-19/</link>
       <pubDate>Sat, 30 Jan 2021 23:59:00 -0700</pubDate>
       
       <guid>https://blog.fabrefact.ca/posts/virtual-party-space-devlog-19/</guid>
       <description>&lt;p&gt;Today I finally turned my app into a Docker container, by reverse engineering how the Jitsi Dockerfiles work.&lt;/p&gt;
&lt;h1 id=&#34;log&#34;&gt;Log&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;tried using &lt;code&gt;--local&lt;/code&gt; context for docker compose CLI, doesn&amp;rsquo;t seem to do anything useful
&lt;ul&gt;
&lt;li&gt;doesn&amp;rsquo;t recreate the cloudmap service discovery, so back to services not talking to each another&lt;/li&gt;
&lt;li&gt;try creating network aliases that use cloudmap format, to see if can pinpoint issue?&lt;/li&gt;
&lt;li&gt;worried it might be related to &lt;a href=&#34;https://jitsi.github.io/handbook/docs/devops-guide/devops-guide-docker#running-behind-nat-or-on-a-lan-environment&#34;&gt;lacking host ip&lt;/a&gt;, and really don&amp;rsquo;t know how to address not knowing public ip in advance&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;dockerizing own app
&lt;ul&gt;
&lt;li&gt;currently only been running in dev mode, need to set up a container with nginx etc&lt;/li&gt;
&lt;li&gt;can probably crib a lot from docker-jitsi-meet web container&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Dockerfile tips
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://docs.docker.com/develop/dev-best-practices/&#34;&gt;https://docs.docker.com/develop/dev-best-practices/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://cloud.google.com/solutions/best-practices-for-building-containers&#34;&gt;https://cloud.google.com/solutions/best-practices-for-building-containers&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://docs.docker.com/develop/develop-images/dockerfile_best-practices/&#34;&gt;https://docs.docker.com/develop/develop-images/dockerfile_best-practices/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://vuejs.org/v2/cookbook/dockerize-vuejs-app.html&#34;&gt;Tutorial&lt;/a&gt; for turning web app into container with multi-stage dockerfile&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;how-does-docker-jisi-meet-work&#34;&gt;HOW DOES DOCKER-JISI-MEET WORK?&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;project contains a &lt;code&gt;base&lt;/code&gt; image built on debian:buster-slim which contains:
&lt;ul&gt;
&lt;li&gt;apt-transport-https apt-utils ca-certificates gnupg wget&lt;/li&gt;
&lt;li&gt;s6 for process management (via an &amp;ldquo;overlay&amp;rdquo;) &lt;a href=&#34;https://github.com/just-containers/s6-overlay&#34;&gt;https://github.com/just-containers/s6-overlay&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Jitsi&amp;rsquo;s GPG keys (what for?)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;frep&lt;/code&gt; templating tool &lt;a href=&#34;https://github.com/subchen/frep&#34;&gt;https://github.com/subchen/frep&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;a couple wrapper commands &lt;code&gt;apt-dpkg-wrap&lt;/code&gt;, &lt;code&gt;apt-cleanup&lt;/code&gt;, and &lt;code&gt;tpl&lt;/code&gt; to be used in the other dockerfiles&lt;/li&gt;
&lt;li&gt;if built using the &lt;code&gt;unstable&lt;/code&gt; release, also installs jq procps curl vim iputils-ping net-tools&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;base image sets &lt;code&gt;apt-get&lt;/code&gt; sources for debian and jitsi packages (so if want to use custom source, will have to add new)&lt;/li&gt;
&lt;li&gt;each container image extends base by installing at least one jitsi package and some public packages
&lt;ul&gt;
&lt;li&gt;uses the wrapper commands from base image for installing and cleanup&lt;/li&gt;
&lt;li&gt;web uses &lt;code&gt;ADD&lt;/code&gt; docker command instead of apt-get for acme, maybe not available in apt?&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;each service contains a &lt;code&gt;rootfs&lt;/code&gt; folder containing config for the service
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;etc&lt;/code&gt; is mostly process running directions for s6
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;cont-init.d&lt;/code&gt; contains bash script to run when the container initializes&lt;/li&gt;
&lt;li&gt;&lt;code&gt;services.d&lt;/code&gt; contains run commands for processes that run in this service&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;defaults&lt;/code&gt; is templates for things like nginx configs, including environment variables
&lt;ul&gt;
&lt;li&gt;these templates are expanded into the mapped &lt;code&gt;/config&lt;/code&gt; directory using the &lt;code&gt;tpl&lt;/code&gt; wrapper command around &lt;code&gt;frep&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;upon container start, s6 runs &lt;code&gt;10-config&lt;/code&gt; init script, which contains &lt;code&gt;tpl&lt;/code&gt; commands to recreate &lt;code&gt;/config&lt;/code&gt; files from &lt;code&gt;/defaults&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;web&lt;/code&gt; container runs nginx and a cron that runs Lets Encrypt regularly&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;more-about-whether-to-use-volumes-or-not&#34;&gt;more about whether to use volumes or not&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&amp;ldquo;By default all files created inside a container are stored on a writable container layer&amp;rdquo; &lt;a href=&#34;https://docs.docker.com/storage/&#34;&gt;https://docs.docker.com/storage/&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;not persistent when container goes down&lt;/li&gt;
&lt;li&gt;hard to move to other hosts&lt;/li&gt;
&lt;li&gt;storage driver reduces performance&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;for the most part, contents of volumes are just config files that are written every time the container starts
&lt;ul&gt;
&lt;li&gt;probably no need to use persistent storage, but also no need to copy in files&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Let&amp;rsquo;s Encrypt certificates &lt;em&gt;do&lt;/em&gt; need to be persisted&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;trying-new-more-ecs-friendly-setup-for-docker-jitsi-meet&#34;&gt;trying new, more ECS-friendly setup for docker-jitsi-meet&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;renamed network aliases to what CloudMap will call them&amp;ndash;seems to work locally, TBD remote&lt;/li&gt;
&lt;li&gt;need to think about setting URIs etc in my app via environment variables
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://medium.com/chingu/an-introduction-to-environment-variables-and-how-to-use-them-f602f66d15fa&#34;&gt;https://medium.com/chingu/an-introduction-to-environment-variables-and-how-to-use-them-f602f66d15fa&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;dotenv library caused an error because I&amp;rsquo;m building for web, not node. Tried dotenv-webpack instead&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/webpack-contrib/css-loader/issues/447&#34;&gt;https://github.com/webpack-contrib/css-loader/issues/447&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.npmjs.com/package/dotenv-webpack&#34;&gt;https://www.npmjs.com/package/dotenv-webpack&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;bug-fixes&#34;&gt;Bug fixes&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;getting &amp;ldquo;Bridge Channel send: no opened channel.&amp;rdquo; error a bunch, but doesn&amp;rsquo;t seem to actually be any configuration problem &amp;amp; went away on its own.
&lt;ul&gt;
&lt;li&gt;this usually means the UDP port for the JVB server isn&amp;rsquo;t accessible&lt;/li&gt;
&lt;li&gt;may correlate to &amp;ldquo;WARNING: Took &amp;lt;##&amp;gt; ms to handle IQ:&amp;rdquo; messages in JVB log?&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;found source of non-player avatar not moving when browser tab not focused bug
&lt;ul&gt;
&lt;li&gt;Most browsers pause activity when tab isn&amp;rsquo;t focused, so best case is to detect either blur/focus or pause/resume and change movement behaviour based on state&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://phaser.discourse.group/t/code-execution-when-coming-back-from-another-tab/1403&#34;&gt;https://phaser.discourse.group/t/code-execution-when-coming-back-from-another-tab/1403&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://photonstorm.github.io/phaser3-docs/Phaser.Core.Events.html&#34;&gt;https://photonstorm.github.io/phaser3-docs/Phaser.Core.Events.html&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;the-perils-of-libraries&#34;&gt;The perils of libraries&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Made some quick progress with dockerizing, but got blocked on Calla not being able to be included in any normal way
&lt;ul&gt;
&lt;li&gt;npm file:.. syntax being outside the Docker context was an issue, as expected&lt;/li&gt;
&lt;li&gt;internet suggestion to use Dockerfile in parent directory was a nightmare because entire &lt;code&gt;projects&lt;/code&gt; directory gets loaded in as context, which is many Gb (still didn&amp;rsquo;t work)&lt;/li&gt;
&lt;li&gt;tried including as tar.gz but kept running into issues with the &lt;code&gt;my-rollup&lt;/code&gt; dev dependency
&lt;ul&gt;
&lt;li&gt;I think this was actually due to &lt;code&gt;package-lock.json&lt;/code&gt;, and might have worked in the end&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Chosen path: turn Calla into a proper dependency (and by extension, its dependencies &lt;code&gt;kudzu&lt;/code&gt; and &lt;code&gt;my-rollup&lt;/code&gt;)
&lt;ul&gt;
&lt;li&gt;using &lt;a href=&#34;https://verdaccio.org/en/&#34;&gt;Verdaccio&lt;/a&gt; as local npm repository
&lt;ul&gt;
&lt;li&gt;(set as my default repository, remember this when working on other projects)&lt;/li&gt;
&lt;li&gt;had to &amp;ldquo;log in&amp;rdquo;, created account and put in password manager&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;look up how to publish packages (&lt;code&gt;npm publish&lt;/code&gt;)&lt;/li&gt;
&lt;li&gt;use &lt;code&gt;npm pack&lt;/code&gt; on &lt;code&gt;my-rollup&lt;/code&gt; because it&amp;rsquo;s just a build script I don&amp;rsquo;t ever want to touch or use&lt;/li&gt;
&lt;li&gt;publish &lt;code&gt;kudzu&lt;/code&gt; to verdaccio&lt;/li&gt;
&lt;li&gt;publish &lt;code&gt;calla&lt;/code&gt; to verdaccio&lt;/li&gt;
&lt;li&gt;install still fails due to complaining about some typescript syntax, because package contains TS
&lt;ul&gt;
&lt;li&gt;look into &lt;a href=&#34;https://medium.com/cameron-nokes/the-30-second-guide-to-publishing-a-typescript-package-to-npm-89d93ff7bccd&#34;&gt;how you&amp;rsquo;re supposed to publish TS&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Calla doesn&amp;rsquo;t use an outDir, so js files are intermingled with ts files
&lt;ul&gt;
&lt;li&gt;edit tsconfig, publish from ./dist folder (remember to actually include folder!)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;app still can&amp;rsquo;t find calla, because &lt;code&gt;main&lt;/code&gt; was set incorrectly in package.json&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Calla.js&lt;/code&gt; was incorrectly capitalized because I was trying to cheat and reuse the &lt;code&gt;dist&lt;/code&gt; directory, which already had &lt;code&gt;calla.js&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;(this is going to be a problem if I accidentally run the build script instead of just &lt;code&gt;tsc&lt;/code&gt;)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;additional-configuration&#34;&gt;Additional configuration&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;got all the server stuff in the same docker-compose as my app, just need to get the extra nginx stuff working
&lt;ul&gt;
&lt;li&gt;nginx configs contain environment variables, which need to get replaced with env vars passed in Docker build&lt;/li&gt;
&lt;li&gt;jitsi containers use &lt;code&gt;frep&lt;/code&gt; for env variable replacements, could do that, but requires learning to start a script&lt;/li&gt;
&lt;li&gt;&lt;code&gt;envsubstr&lt;/code&gt; is a linux cli tool for replacing env vars, still requires a bit of scripting&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://hub.docker.com/_/nginx&#34;&gt;nginx alpine image&lt;/a&gt; supports &lt;code&gt;envsubstr&lt;/code&gt; automatically starting in 1.19 (mainline, not stable)
&lt;ul&gt;
&lt;li&gt;could potentially &lt;a href=&#34;https://unix.stackexchange.com/questions/294378/replacing-only-specific-variables-with-envsubst&#34;&gt;replace valid nginx confs that start with $&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;lets encrypt certificates are good for 90 days, so I only need to get one once and store on volume&lt;/li&gt;
&lt;li&gt;made sure local lib-jitsi-meet got loaded so Calla doesn&amp;rsquo;t try to download it again&lt;/li&gt;
&lt;li&gt;struggled with HTTPS for SO LONG and it looks like the problem was just reusing ports that another container was using.
&lt;ul&gt;
&lt;li&gt;copied over more of the jitsi web configs, probably didn&amp;rsquo;t need to do that&lt;/li&gt;
&lt;li&gt;changing ports instantly worked&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;about-this-series&#34;&gt;About this series&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;Back in mid-December I started an ambitious project to create a custom platform for a virtual birthday party in February. I kept notes on my progress, both for personal reference and to turn into a series of blog posts. It quickly became apparent that I did not have time to both &lt;em&gt;do the project&lt;/em&gt; and &lt;em&gt;blog about the project&lt;/em&gt;. I have retroactively decided to post my raw notes as a dev log.&lt;/p&gt;
&lt;/blockquote&gt;</description>
     </item>
   
     <item>
       <title>Virtual Party Space Devlog #18: Victory over AWS!</title>
       <link>https://blog.fabrefact.ca/posts/virtual-party-space-devlog-18/</link>
       <pubDate>Fri, 29 Jan 2021 23:59:00 -0700</pubDate>
       
       <guid>https://blog.fabrefact.ca/posts/virtual-party-space-devlog-18/</guid>
       <description>&lt;p&gt;A few more days struggling with docker-compose and AWS, and finally get the service running in ECS!&lt;/p&gt;
&lt;h1 id=&#34;log&#34;&gt;Log&lt;/h1&gt;
&lt;h3 id=&#34;wednesday-january-27&#34;&gt;Wednesday, January 27&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;asked for ECS help, didn&amp;rsquo;t get it&lt;/li&gt;
&lt;li&gt;looking into making secondary conference rooms
&lt;ul&gt;
&lt;li&gt;made an interior map&lt;/li&gt;
&lt;li&gt;probably need additional scenes for each room
&lt;ul&gt;
&lt;li&gt;refactor GameScene to be a parent class, and have all specific maps/images in specific scene classes&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://netexl.com/blog/exploring-phaser-3-with-a-game-adding-multiple-scenes/&#34;&gt;Tutorial for adding multiple scenes&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Checked licenses on Jitsi &amp;amp; Calla - no usage restrictions, so I can choose ethical source library&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;thursday-january-28&#34;&gt;Thursday, January 28&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;tried out AWS again, still couldn&amp;rsquo;t figure out how to get endpoint working
&lt;ul&gt;
&lt;li&gt;confirmed &lt;code&gt;docker compose down&lt;/code&gt; works if context is passed&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;reconfigured Dockerfiles to contain config instead of bind mounts
&lt;ul&gt;
&lt;li&gt;learned how to build docker containers!&lt;/li&gt;
&lt;li&gt;works locally&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;friday-january-29&#34;&gt;Friday, January 29&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;looking into how to make services talk to one another
&lt;ul&gt;
&lt;li&gt;searching for &lt;a href=&#34;https://docs.aws.amazon.com/AmazonECS/latest/developerguide/service-discovery.html&#34;&gt;ECS service discovery&lt;/a&gt; seems promising&lt;/li&gt;
&lt;li&gt;read about &lt;a href=&#34;https://docs.aws.amazon.com/cloud-map/latest/dg/what-is-cloud-map.html&#34;&gt;CloudMap&lt;/a&gt;, think I understand the &amp;ldquo;service discovery&amp;rdquo; portion of the Compose CLI docs now
&lt;ul&gt;
&lt;li&gt;need to change internal network base to be &lt;!-- raw HTML omitted --&gt;.local instead of meet.jitsi&lt;/li&gt;
&lt;li&gt;can refer to other containers directly by service name too&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;updated &lt;code&gt;docker-compose&lt;/code&gt; and environment vars to use CloudMap syntax
&lt;ul&gt;
&lt;li&gt;WEB SERVER WORKS NOW!!&lt;/li&gt;
&lt;li&gt;https doesn&amp;rsquo;t work (still need to set up domain I think in order to use LetsEncrypt?)&lt;/li&gt;
&lt;li&gt;probably still some settings wrong, can&amp;rsquo;t connect to conference
&lt;ul&gt;
&lt;li&gt;websocket &amp;ldquo;public url&amp;rdquo; definitely wrong&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;since jicofo/prosody have to be single instance for single conference, how to turn off availability zones?&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;about-this-series&#34;&gt;About this series&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;Back in mid-December I started an ambitious project to create a custom platform for a virtual birthday party in February. I kept notes on my progress, both for personal reference and to turn into a series of blog posts. It quickly became apparent that I did not have time to both &lt;em&gt;do the project&lt;/em&gt; and &lt;em&gt;blog about the project&lt;/em&gt;. I have retroactively decided to post my raw notes as a dev log.&lt;/p&gt;
&lt;/blockquote&gt;</description>
     </item>
   
     <item>
       <title>Virtual Party Space Devlog #17: Translating docker-compose files for AWS</title>
       <link>https://blog.fabrefact.ca/posts/virtual-party-space-devlog-17/</link>
       <pubDate>Mon, 25 Jan 2021 23:59:00 -0700</pubDate>
       
       <guid>https://blog.fabrefact.ca/posts/virtual-party-space-devlog-17/</guid>
       <description>&lt;p&gt;Spent a couple days fighting with Docker and the ECS integration of docker-compose.&lt;/p&gt;
&lt;h1 id=&#34;log&#34;&gt;Log&lt;/h1&gt;
&lt;h2 id=&#34;sunday-january-24&#34;&gt;Sunday, January 24&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;turns out can&amp;rsquo;t connect to Jitsi server when using &lt;code&gt;docker compose&lt;/code&gt; instead of &lt;code&gt;docker-compose&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;getting &lt;code&gt;PR_END_OF_FILE_ERROR&lt;/code&gt;, so probably SSL certificates aren&amp;rsquo;t set up properly? (not even whatever self-signed one I&amp;rsquo;m using)&lt;/li&gt;
&lt;li&gt;switched back to &lt;code&gt;docker-compose&lt;/code&gt; for the purpose of playing around&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;fixed bug where leaving and rejoining the same conference would not reload the avatars for participants who had stayed in
&lt;ul&gt;
&lt;li&gt;addParticipant was tied to the loadImage callback, but in this case the image was already loaded&lt;/li&gt;
&lt;li&gt;tried just deleting image from textureManager on participant remove, but that caused a game crash when phaser tried to render nonexistent texture
&lt;ul&gt;
&lt;li&gt;only happened on second time (consistently), no idea why&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;made loading of image conditional on if texture already exists, all other stuff the same
&lt;ul&gt;
&lt;li&gt;should player avatars ever be unloaded? If so how?&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;fixed bug where pathfinder didn&amp;rsquo;t recognize obstacles on anything but scenery layer, and treated some ground tiles as obstacles
&lt;ul&gt;
&lt;li&gt;possibly should simplify by consolidating most tiles onto single layer?
&lt;ul&gt;
&lt;li&gt;might be more complicated for other existing logic/image loading though&lt;/li&gt;
&lt;li&gt;may also suggest consolidating tilesets, which is a good idea but not until i&amp;rsquo;ve finalized the map&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Simply check for collisions in other layers, otherwise just use ground tile&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;tuesday-january-26&#34;&gt;Tuesday, January 26&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;UGH DOCKER
&lt;ul&gt;
&lt;li&gt;still can&amp;rsquo;t figure out why &lt;code&gt;docker compose&lt;/code&gt; doesn&amp;rsquo;t like SSL&lt;/li&gt;
&lt;li&gt;fine then, set up AWS credentials and context&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;trying the docker-&amp;gt;ecs auto deploy thing
&lt;ul&gt;
&lt;li&gt;&amp;ldquo;published port can&amp;rsquo;t be set to a distinct value than container port: incompatible attribute&amp;rdquo;
&lt;ul&gt;
&lt;li&gt;can&amp;rsquo;t use custom ports for 80/443&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&amp;ldquo;ECS Fargate does not support bind mounts from host: incompatible attribute&amp;rdquo;
&lt;ul&gt;
&lt;li&gt;have to learn &lt;a href=&#34;https://maximorlov.com/docker-compose-syntax-volume-or-bind-mount/&#34;&gt;the difference between &amp;ldquo;volumes&amp;rdquo; and &amp;ldquo;bind mounts&amp;rdquo;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;jitsi docker-compose binds config directory for all mounts, have to figure out how to turn those into volumes&lt;/li&gt;
&lt;li&gt;replaced all bind mounts with empty volumes, simply for the purpose of getting to the next error
&lt;ul&gt;
&lt;li&gt;possibly build config directories into docker containers rather than messing around with EFS?&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&amp;ldquo;WARN[0001] services.networks.aliases: unsupported attribute&amp;rdquo;
&lt;ul&gt;
&lt;li&gt;services.networks may not be supported at all?
&lt;ul&gt;
&lt;li&gt;&amp;ldquo;Communication between services is implemented by SecurityGroups within the application VPC.&amp;rdquo;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&amp;ldquo;WARN[0001] services.restart: unsupported attribute&amp;rdquo;
&lt;ul&gt;
&lt;li&gt;Replaced by service.deployment.restart_policy&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;docker compose down&lt;/code&gt; always fails with ENV variables in ports
&lt;ul&gt;
&lt;li&gt;hard coded ports in docker-compose.yml&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;docker compose down&lt;/code&gt; doesn&amp;rsquo;t actually&amp;hellip;do anything
&lt;ul&gt;
&lt;li&gt;use CloudFormation service in AWS console to delete stack&lt;/li&gt;
&lt;li&gt;I WASN&amp;rsquo;T PASSING THE CONTEXT UGH this was user error&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;AWS doesn&amp;rsquo;t provide an easy way to look at every resource you created
&lt;ul&gt;
&lt;li&gt;have to assume cloudformation stack listed them all correctly and deleted all&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;requested ElasticIP in us-west-2 (it was very easy)
&lt;ul&gt;
&lt;li&gt;****TODO: assign URL to IP so I can create a Let&amp;rsquo;s Encrypt&lt;/li&gt;
&lt;li&gt;****TODO: verify which region I want to use&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;notes-for-next-attempt&#34;&gt;notes for next attempt&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Config bind-mounts don&amp;rsquo;t work
&lt;ul&gt;
&lt;li&gt;need to find alternate way to get config directories into containers&lt;/li&gt;
&lt;li&gt;(I think build my own versions of the docker containers with appropriate configs?)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Internal domain aliases don&amp;rsquo;t work (ie xmpp.meet.jitsi)
&lt;ul&gt;
&lt;li&gt;need to find alternate way for services to talk to each other&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;about-this-series&#34;&gt;About this series&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;Back in mid-December I started an ambitious project to create a custom platform for a virtual birthday party in February. I kept notes on my progress, both for personal reference and to turn into a series of blog posts. It quickly became apparent that I did not have time to both &lt;em&gt;do the project&lt;/em&gt; and &lt;em&gt;blog about the project&lt;/em&gt;. I have retroactively decided to post my raw notes as a dev log.&lt;/p&gt;
&lt;/blockquote&gt;</description>
     </item>
   
     <item>
       <title>Virtual Party Space Devlog #16: AWS architecture with docker-compose</title>
       <link>https://blog.fabrefact.ca/posts/virtual-party-space-devlog-16/</link>
       <pubDate>Sat, 23 Jan 2021 23:59:00 -0700</pubDate>
       
       <guid>https://blog.fabrefact.ca/posts/virtual-party-space-devlog-16/</guid>
       <description>&lt;p&gt;Today I finally stopped procrastinating and started seriously looking into how to build this on AWS. (But also fixed a bunch of bugs!)&lt;/p&gt;
&lt;h1 id=&#34;log&#34;&gt;Log&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;looked into &lt;a href=&#34;https://nolanlawson.com/2020/02/19/fixing-memory-leaks-in-web-applications/&#34;&gt;memory leaks&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;initial tests show that memory growth doesn&amp;rsquo;t present over short timeframes&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;added userId to events to allow for multiple-player movement&lt;/li&gt;
&lt;li&gt;modified depth layers so player avatars always drawn in front of scenery at &amp;ldquo;same&amp;rdquo; depth (using step-2 as considered before)
&lt;ul&gt;
&lt;li&gt;still looks weird when player going behind things, but moving in front of buildings now looks right&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;bug-fixes&#34;&gt;Bug fixes&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;took forever to figure out mute bug!
&lt;ul&gt;
&lt;li&gt;calling toggleAudioMuted in conferenceJoined event handler was the problem
&lt;ul&gt;
&lt;li&gt;conferenceJoined event is dispatched before async setAudioInput completes, so toggle would find no input and create a new one, which would then get destroyed when the initial audio input tried to complete.&lt;/li&gt;
&lt;li&gt;always saw 2 adds, 2 removes, so maybe the async calls stepped on each other?&lt;/li&gt;
&lt;li&gt;left with no audio track, new audio track would then be created on hitting mute toggle or switching inputs&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;combined with Calla&amp;rsquo;s not-great idea to use &amp;ldquo;toggle&amp;rdquo; instead of any way of setting directly
&lt;ul&gt;
&lt;li&gt;isAudioMuted was always null so would always toggle, regardless of &amp;ldquo;set&amp;rdquo; value&lt;/li&gt;
&lt;li&gt;even after patching that, initial state is always null, so leads to different behaviour depending if audio track exists or not&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;no easy way to create a track muted
&lt;ul&gt;
&lt;li&gt;startAudioMuted in Jitsi doesn&amp;rsquo;t seem to do anything?&lt;/li&gt;
&lt;li&gt;also tried startMutedPolicy, also doesn&amp;rsquo;t seem to do anything
&lt;ul&gt;
&lt;li&gt;maybe look into these later, but Jitsi is complicated.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;reverted a change to Calla and then discovered it&amp;rsquo;s required to have the &amp;ldquo;None&amp;rdquo; option in audio/video dropdowns
&lt;ul&gt;
&lt;li&gt;redid fix and committed this time&lt;/li&gt;
&lt;li&gt;still on &amp;ldquo;fixes&amp;rdquo; branch of official repo, haven&amp;rsquo;t recalled how to switch origins&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;remote user avatars now properly load to that user&amp;rsquo;s reported position
&lt;ul&gt;
&lt;li&gt;addParticipant is getting sloppy, might want to break this out into somewhere else&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;figured out how to properly add user avatars &amp;amp; positions for all users!
&lt;ul&gt;
&lt;li&gt;requires sending custom Jitsi messages. Calla doesn&amp;rsquo;t have an interface for this, so now I&amp;rsquo;ve polluted my conference code with hard-coded Jitsi references&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;cannot-put-off-aws-anymore&#34;&gt;CANNOT PUT OFF AWS ANYMORE&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;A&lt;/code&gt; recommended Fargate and I guess I see it, going to try tutorials in that direction&lt;/li&gt;
&lt;li&gt;installed ecs cli and upgraded aws-cli
&lt;ul&gt;
&lt;li&gt;****TODO: set up AWS profile&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Eventually get an &lt;a href=&#34;https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/elastic-ip-addresses-eip.html&#34;&gt;Elastic IP&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;cost &amp;lt;$5 for a month&lt;/li&gt;
&lt;li&gt;add CNAME at domain registrar well in advance to get domain name&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;using-docker-compose&#34;&gt;Using docker-compose&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;It&amp;rsquo;s possible to &lt;a href=&#34;https://aws.amazon.com/blogs/containers/deploy-applications-on-amazon-ecs-using-docker-compose/&#34;&gt;use docker-compose with ECS&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://docs.docker.com/cloud/ecs-integration/&#34;&gt;https://docs.docker.com/cloud/ecs-integration/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;this seems to avoid the need to create cloudformation templates and just turns your docker-compose.yml into cloudformation
&lt;ul&gt;
&lt;li&gt;can use &lt;code&gt;docker compose convert&lt;/code&gt; to just generate the cloudformation and manually tweak&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;can reuse much of the existing jitsi docker project, just update if I need to do something custom with jvb
&lt;ul&gt;
&lt;li&gt;I think I&amp;rsquo;m getting the picture that despite the visualization in Docker Desktop, all the different containers are actually entirely separate&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;can also test AWS context locally &lt;a href=&#34;https://aws.amazon.com/blogs/compute/a-guide-to-locally-testing-containers-with-amazon-ecs-local-endpoints-and-docker-compose/&#34;&gt;https://aws.amazon.com/blogs/compute/a-guide-to-locally-testing-containers-with-amazon-ecs-local-endpoints-and-docker-compose/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;need to add features like:
&lt;ul&gt;
&lt;li&gt;resources (max CPU and memory per service)&lt;/li&gt;
&lt;li&gt;x-aws-* parameters&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Can specify a .env file for docker-compose &lt;a href=&#34;https://docs.aws.amazon.com/AmazonECS/latest/developerguide/taskdef-envfiles.html&#34;&gt;https://docs.aws.amazon.com/AmazonECS/latest/developerguide/taskdef-envfiles.html&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;unfortunately this might not work for the docker binary, which is required for ECS features
&lt;ul&gt;
&lt;li&gt;.env file support added a couple weeks ago, might work? Installing new Docker Desktop version&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;****TODO: figure out SSL certificates&lt;/li&gt;
&lt;li&gt;****TODO: pull passwords out of .env and put them into secrets manager
&lt;ul&gt;
&lt;li&gt;learn how secrets work I guess&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;other-considerations&#34;&gt;Other considerations&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;I think the only thing the &amp;ldquo;web&amp;rdquo; docker container is used for is proxying http-bind on to xmpp.meet.jitsi:5280
&lt;ul&gt;
&lt;li&gt;could ditch &amp;ldquo;web&amp;rdquo; altogether, and replace it with a container of my app?&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;my code is getting complicated enough that I&amp;rsquo;m starting to break features when adding a new feature, probably need tests
&lt;ul&gt;
&lt;li&gt;unfortunately most of my test needs are integration/e2e, not sure how to test ie jitsi connection events
&lt;ul&gt;
&lt;li&gt;a mock of lib-jitsi-meet would take so long to write&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;about-this-series&#34;&gt;About this series&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;Back in mid-December I started an ambitious project to create a custom platform for a virtual birthday party in February. I kept notes on my progress, both for personal reference and to turn into a series of blog posts. It quickly became apparent that I did not have time to both &lt;em&gt;do the project&lt;/em&gt; and &lt;em&gt;blog about the project&lt;/em&gt;. I have retroactively decided to post my raw notes as a dev log.&lt;/p&gt;
&lt;/blockquote&gt;</description>
     </item>
   
     <item>
       <title>Virtual Party Space Devlog #15: Tile-based pathfinding</title>
       <link>https://blog.fabrefact.ca/posts/virtual-party-space-devlog-15/</link>
       <pubDate>Fri, 22 Jan 2021 23:59:00 -0700</pubDate>
       
       <guid>https://blog.fabrefact.ca/posts/virtual-party-space-devlog-15/</guid>
       <description>&lt;p&gt;Spent a few days puttering around with pathfinding and rendering isometric movement in Phaser.&lt;/p&gt;
&lt;h1 id=&#34;log&#34;&gt;Log&lt;/h1&gt;
&lt;h3 id=&#34;wednesday-january-20&#34;&gt;Wednesday, January 20&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;poked around with pathfinder some more&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;thursday-january-21&#34;&gt;Thursday, January 21&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;generalized depth-layer code a bit and added buildings to it.
&lt;ul&gt;
&lt;li&gt;Buildings don&amp;rsquo;t work as well for some reason? Flickering when sprite transitions from in-front to behind
&lt;ul&gt;
&lt;li&gt;potentially make depth layers step-2? so sprites can always be above scenery at &amp;ldquo;same&amp;rdquo; depth&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;tried switching movement to event-driven as opposed to every update, but made movement very choppy&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;friday-january-22&#34;&gt;Friday, January 22&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;hacked pathfinder to get it working
&lt;ul&gt;
&lt;li&gt;relies on EventEmitter to tell Pathfinder when to try next step
&lt;ul&gt;
&lt;li&gt;because &lt;a href=&#34;https://phasergames.com/phaser-3-dispatching-custom-events/&#34;&gt;custom events tutorial&lt;/a&gt; designed EventEmitter as singleton, events only work for single player
&lt;ul&gt;
&lt;li&gt;could add userId to event name?&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;tile-based pathfinding looks pretty rough&lt;/li&gt;
&lt;li&gt;pathfinder currently only has ground layer so is stymied by obstacles in scenery layer
&lt;ul&gt;
&lt;li&gt;if movement is blocked it just stops forever, path is never recalculated&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;about-this-series&#34;&gt;About this series&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;Back in mid-December I started an ambitious project to create a custom platform for a virtual birthday party in February. I kept notes on my progress, both for personal reference and to turn into a series of blog posts. It quickly became apparent that I did not have time to both &lt;em&gt;do the project&lt;/em&gt; and &lt;em&gt;blog about the project&lt;/em&gt;. I have retroactively decided to post my raw notes as a dev log.&lt;/p&gt;
&lt;/blockquote&gt;</description>
     </item>
   
     <item>
       <title>Virtual Party Space Devlog #14: From dev to cloud</title>
       <link>https://blog.fabrefact.ca/posts/virtual-party-space-devlog-14/</link>
       <pubDate>Tue, 19 Jan 2021 23:59:00 -0700</pubDate>
       
       <guid>https://blog.fabrefact.ca/posts/virtual-party-space-devlog-14/</guid>
       <description>&lt;p&gt;Today I dig into how to get my app running in the cloud instead of just on my laptop.&lt;/p&gt;
&lt;h1 id=&#34;log&#34;&gt;Log&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;realised Calla is sending a network message on every draw cycle, so rejiggered movePlayer to only fire on tile move
&lt;ul&gt;
&lt;li&gt;use Calla math to adjust audio over time (not necessarily synced with sprite movement)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;aws-architecture-ideas&#34;&gt;AWS architecture ideas&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;A&lt;/code&gt; recommends sticking with Docker for production env
&lt;ul&gt;
&lt;li&gt;explained how docker-jitsi-meet works
&lt;ul&gt;
&lt;li&gt;docker-compose is like a build runner for docker, don&amp;rsquo;t necessarily need to use it but whatever, it&amp;rsquo;s what&amp;rsquo;s there
&lt;ul&gt;
&lt;li&gt;file pulls images from public docker repository&lt;/li&gt;
&lt;li&gt;if I want to use my own changes, edit the project and build using makefile, and change the tag in the docker-compose
&lt;ul&gt;
&lt;li&gt;(this is probably what the documentation says but I understand it now)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;the selenium grid tutorial is a good approach but their way of handing VMs is hard to follow, just use docker instead&lt;/li&gt;
&lt;li&gt;use ECS fargate for cost savings
&lt;ul&gt;
&lt;li&gt;going by recommended instance size from jitsi docs, basic shard should be ~$1/hr&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;can get a public IP from AWS for ~a month to point my DNS record at&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;found a &lt;a href=&#34;https://github.com/taktakpeops/selenium-grid-ecs-fargate&#34;&gt;selenium grid fargate/cloudformation github project&lt;/a&gt;, maybe can use as load testing base&lt;/li&gt;
&lt;li&gt;still need to figure out where my code will live, probably on the web server. Can I jettison all the meet front end?&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;about-this-series&#34;&gt;About this series&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;Back in mid-December I started an ambitious project to create a custom platform for a virtual birthday party in February. I kept notes on my progress, both for personal reference and to turn into a series of blog posts. It quickly became apparent that I did not have time to both &lt;em&gt;do the project&lt;/em&gt; and &lt;em&gt;blog about the project&lt;/em&gt;. I have retroactively decided to post my raw notes as a dev log.&lt;/p&gt;
&lt;/blockquote&gt;</description>
     </item>
   
     <item>
       <title>Virtual Party Space Devlog #13: Server-side architecture</title>
       <link>https://blog.fabrefact.ca/posts/virtual-party-space-devlog-13/</link>
       <pubDate>Mon, 18 Jan 2021 23:59:00 -0700</pubDate>
       
       <guid>https://blog.fabrefact.ca/posts/virtual-party-space-devlog-13/</guid>
       <description>&lt;p&gt;Today I start looking into server-side architecture to support a large number of simultaneous users, and also put in pathfinding for other players&#39; avatars.&lt;/p&gt;
&lt;h1 id=&#34;log&#34;&gt;Log&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;More research into scalable architecture, looks like 150 participants is stretching the capabilities of Jitsi
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://community.jitsi.org/t/maximum-number-of-participants-on-a-meeting-on-meet-jit-si-server/22273/31&#34;&gt;https://community.jitsi.org/t/maximum-number-of-participants-on-a-meeting-on-meet-jit-si-server/22273/31&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://community.jitsi.org/t/whats-the-number-of-the-maximum-users-in-the-same-video-conference/82998/16&#34;&gt;https://community.jitsi.org/t/whats-the-number-of-the-maximum-users-in-the-same-video-conference/82998/16&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://community.jitsi.org/t/multi-shard-auto-scalable-kubernetes-setup/64685&#34;&gt;https://community.jitsi.org/t/multi-shard-auto-scalable-kubernetes-setup/64685&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://community.jitsi.org/t/support-for-large-100-user-conferences-timeline-and-contribution/32247/13&#34;&gt;https://community.jitsi.org/t/support-for-large-100-user-conferences-timeline-and-contribution/32247/13&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://aws.amazon.com/blogs/opensource/getting-started-with-jitsi-an-open-source-web-conferencing-solution/&#34;&gt;https://aws.amazon.com/blogs/opensource/getting-started-with-jitsi-an-open-source-web-conferencing-solution/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://community.jitsi.org/t/tutorial-loadtesting-jitsi-with-malleusjitsificus-on-a-selenium-grid/33302&#34;&gt;load testing tutorial&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;architecture-conclusions&#34;&gt;Architecture conclusions&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;to be in same conference, all users need to hit same jicofo instance (can only scale vertically)&lt;/li&gt;
&lt;li&gt;prosody is single-threaded and may also be a blocker &lt;a href=&#34;https://community.jitsi.org/t/site-slowing-down-on-concurrent-connections/80822/17&#34;&gt;https://community.jitsi.org/t/site-slowing-down-on-concurrent-connections/80822/17&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;jvb can be separate, and can load-balance multiple servers for same conference using Octo&lt;/li&gt;
&lt;li&gt;limitation is bandwidth/client bandwidth
&lt;ul&gt;
&lt;li&gt;last-n is probably required if most people sending video&lt;/li&gt;
&lt;li&gt;need to come up with distance-based-n solution&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;interface&#34;&gt;Interface&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;started putting pathfinding in to allow for other-player movement and also mouse-based movement
&lt;ul&gt;
&lt;li&gt;pulled in easystar&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;started changing gridphysics/player code to work with additional sprites
&lt;ul&gt;
&lt;li&gt;looked into improving isometric math, but it might actually be as good as it gets?&lt;/li&gt;
&lt;li&gt;removed some extra Vector object creations from methods that get called every draw cycle
&lt;ul&gt;
&lt;li&gt;don&amp;rsquo;t know that this actually makes a difference but creating 60 objects/second must add up?&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;about-this-series&#34;&gt;About this series&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;Back in mid-December I started an ambitious project to create a custom platform for a virtual birthday party in February. I kept notes on my progress, both for personal reference and to turn into a series of blog posts. It quickly became apparent that I did not have time to both &lt;em&gt;do the project&lt;/em&gt; and &lt;em&gt;blog about the project&lt;/em&gt;. I have retroactively decided to post my raw notes as a dev log.&lt;/p&gt;
&lt;/blockquote&gt;</description>
     </item>
   
     <item>
       <title>Virtual Party Space Devlog #12: Player avatars</title>
       <link>https://blog.fabrefact.ca/posts/virtual-party-space-devlog-12/</link>
       <pubDate>Sun, 17 Jan 2021 23:59:00 -0700</pubDate>
       
       <guid>https://blog.fabrefact.ca/posts/virtual-party-space-devlog-12/</guid>
       <description>&lt;p&gt;Today I add the ability to have player avatars, and realise I have to build my own character creator to get the features I want.&lt;/p&gt;
&lt;h1 id=&#34;log&#34;&gt;Log&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;had trouble with getting event out of GamePhysics, so moving audio location using update
&lt;ul&gt;
&lt;li&gt;BUG: this updates audio location every frame, change to only update when changed RESOLVED&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;finished adding code to change player avatar and make it an in-game object
&lt;ul&gt;
&lt;li&gt;currently only works for participants who join after you&lt;/li&gt;
&lt;li&gt;new objects are on an orthographic grid and don&amp;rsquo;t have movement. GridPhysics class needs adjustments to work&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;BUG: leaving conference caused exception when calla.localUserId still exists but user had been removed from local array RESOLVED&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;character-creator&#34;&gt;Character Creator&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;researching how to do layers in Canvas
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://itnext.io/building-a-game-with-typescript-drawing-grid-5-5-49454917b3af&#34;&gt;https://itnext.io/building-a-game-with-typescript-drawing-grid-5-5-49454917b3af&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API/Tutorial/Optimizing_canvas&#34;&gt;https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API/Tutorial/Optimizing_canvas&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;started drawing using Sketchbook on iPad
&lt;ul&gt;
&lt;li&gt;can export as PSD to mac, apparently
&lt;ul&gt;
&lt;li&gt;save each layer as separate image for use in creator&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;about-this-series&#34;&gt;About this series&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;Back in mid-December I started an ambitious project to create a custom platform for a virtual birthday party in February. I kept notes on my progress, both for personal reference and to turn into a series of blog posts. It quickly became apparent that I did not have time to both &lt;em&gt;do the project&lt;/em&gt; and &lt;em&gt;blog about the project&lt;/em&gt;. I have retroactively decided to post my raw notes as a dev log.&lt;/p&gt;
&lt;/blockquote&gt;</description>
     </item>
   
     <item>
       <title>Virtual Party Space Devlog #11: Refactoring</title>
       <link>https://blog.fabrefact.ca/posts/virtual-party-space-devlog-11/</link>
       <pubDate>Sat, 16 Jan 2021 23:59:00 -0700</pubDate>
       
       <guid>https://blog.fabrefact.ca/posts/virtual-party-space-devlog-11/</guid>
       <description>&lt;p&gt;Today I continue resolving bugs, but also start refactoring my spaghetti code and looking into resources to make a character creator.&lt;/p&gt;
&lt;h1 id=&#34;log&#34;&gt;Log&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;local user DOM elements weren&amp;rsquo;t being removed because by the time it was called &lt;code&gt;calla.localUserId&lt;/code&gt; was reset, so just unload all elements on leave&lt;/li&gt;
&lt;li&gt;username wasn&amp;rsquo;t being loaded because I had hardcoded username to empty string before I figured out where to get username from! RESOLVED&lt;/li&gt;
&lt;li&gt;video wasn&amp;rsquo;t being loaded on conference join because I was calling setPreferredDevice with ID, instead of MediaDevicInfo object
&lt;ul&gt;
&lt;li&gt;audio still autoloaded because Calla passes in a flag to try loading even if preferred device not set
&lt;ul&gt;
&lt;li&gt;this is why I unexpectedly had audio feedback issues&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;video is passed with flag to only use preferred device, so have to set it first RESOLVED&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;need to make select box update when Calla updates audio source by other means RESOLVED&lt;/li&gt;
&lt;li&gt;want option to mute, since can&amp;rsquo;t prevent audio from loading RESOLVED
&lt;ul&gt;
&lt;li&gt;might still be broken, sometimes the mute flag gets reversed, can&amp;rsquo;t quite pin down why&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;uigame&#34;&gt;UI/Game&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;trying to resolve the circular reference problem, here is the plan:
&lt;ul&gt;
&lt;li&gt;refactor GameScene out of main.ts&lt;/li&gt;
&lt;li&gt;refactor most of Conference.ts into a class
&lt;ul&gt;
&lt;li&gt;all references to Calla contained here&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;move random non-class code from Conference into main
&lt;ul&gt;
&lt;li&gt;main imports Conference class, all current function calls turned into conf.&lt;!-- raw HTML omitted --&gt; calls&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Conference class has GameScene member
&lt;ul&gt;
&lt;li&gt;adds event listeners on important GameScene events (and GridPhysics?)
&lt;ul&gt;
&lt;li&gt;update&lt;/li&gt;
&lt;li&gt;movePlayerSprite&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;can call GameScene methods directly to send info the other way&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;character-creator&#34;&gt;Character Creator&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Create character avatars in a picrew-like interface&lt;/li&gt;
&lt;li&gt;Identified favourite reference picrews
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://picrew.me/image_maker/257476&#34;&gt;https://picrew.me/image_maker/257476&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://picrew.me/image_maker/43383&#34;&gt;https://picrew.me/image_maker/43383&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Listed needed art assets and likely categories&lt;/li&gt;
&lt;li&gt;picrew uses &lt;a href=&#34;https://kenwheeler.github.io/slick/&#34;&gt;carousel&lt;/a&gt; for paging through categories of assets&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;about-this-series&#34;&gt;About this series&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;Back in mid-December I started an ambitious project to create a custom platform for a virtual birthday party in February. I kept notes on my progress, both for personal reference and to turn into a series of blog posts. It quickly became apparent that I did not have time to both &lt;em&gt;do the project&lt;/em&gt; and &lt;em&gt;blog about the project&lt;/em&gt;. I have retroactively decided to post my raw notes as a dev log.&lt;/p&gt;
&lt;/blockquote&gt;</description>
     </item>
   
     <item>
       <title>Virtual Party Space Devlog #10: Rendering isometric tiles</title>
       <link>https://blog.fabrefact.ca/posts/virtual-party-space-devlog-10/</link>
       <pubDate>Fri, 15 Jan 2021 23:59:00 -0700</pubDate>
       
       <guid>https://blog.fabrefact.ca/posts/virtual-party-space-devlog-10/</guid>
       <description>&lt;p&gt;Today I struggle with videoconference connections and look into isometric rendering and pathfinding for the game interface.&lt;/p&gt;
&lt;h1 id=&#34;log&#34;&gt;Log&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;spent 4 hours trying to figure out why videobridge wasn&amp;rsquo;t connecting
&lt;ul&gt;
&lt;li&gt;turns out I made a poor choice to use host.docker.internal in docker .ENV, which doesn&amp;rsquo;t work. Replaced with IP RESOLVED&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;tested with 2 users, mostly works fine&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;uigame&#34;&gt;UI/Game&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;made isometric depth work
&lt;ul&gt;
&lt;li&gt;load tilesets as spritesheets instead of images, load each tile individually&lt;/li&gt;
&lt;li&gt;Algorithm: depth = x + y + (base depth for foreground objects)
&lt;ul&gt;
&lt;li&gt;means depth increases evenly on the diagonal&lt;/li&gt;
&lt;li&gt;causes irregular results if player character is sharing same tile as another object (layered objects should be blocking)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;looked into pathfinding to enable mouse navigation/find-my-friend
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://www.dynetisgames.com/2018/03/06/pathfinding-easystar-phaser-3/&#34;&gt;Easystar library&lt;/a&gt; Looks like a good option&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;about-this-series&#34;&gt;About this series&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;Back in mid-December I started an ambitious project to create a custom platform for a virtual birthday party in February. I kept notes on my progress, both for personal reference and to turn into a series of blog posts. It quickly became apparent that I did not have time to both &lt;em&gt;do the project&lt;/em&gt; and &lt;em&gt;blog about the project&lt;/em&gt;. I have retroactively decided to post my raw notes as a dev log.&lt;/p&gt;
&lt;/blockquote&gt;</description>
     </item>
   
     <item>
       <title>Virtual Party Space Devlog #9: Testing continues</title>
       <link>https://blog.fabrefact.ca/posts/virtual-party-space-devlog-9/</link>
       <pubDate>Thu, 14 Jan 2021 23:59:00 -0700</pubDate>
       
       <guid>https://blog.fabrefact.ca/posts/virtual-party-space-devlog-9/</guid>
       <description>&lt;p&gt;Today I continue to identify and resolve bugs with the Calla library.&lt;/p&gt;
&lt;h1 id=&#34;log&#34;&gt;Log&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Bug: changing video sources doesn&amp;rsquo;t work
&lt;ul&gt;
&lt;li&gt;if removeTrack called, addTrack will always be skipped&lt;/li&gt;
&lt;li&gt;problem with &lt;code&gt;BaseConferenctClient.getNext()&lt;/code&gt; -&amp;gt; resolve is never called
&lt;ul&gt;
&lt;li&gt;what is evt.id? It&amp;rsquo;s compared to UserId, do we expect it to be userid? (Yes, apparently)&lt;/li&gt;
&lt;li&gt;&amp;ldquo;videoRemoved&amp;rdquo; event never fires, so await&amp;hellip;waits&amp;hellip; indefinitely. RESOLVED (bug in Calla)
&lt;ul&gt;
&lt;li&gt;this may also be what&amp;rsquo;s happening in Calla.join
&lt;ul&gt;
&lt;li&gt;metadata.join waits for &amp;lsquo;conference.dataChannelOpened&amp;rsquo;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Bug: leaving conference doesn&amp;rsquo;t clean up properly (Jitsi connection still pinging http-bind)
&lt;ul&gt;
&lt;li&gt;added await to conference.leave in JitsiConferenceClient.leave&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;rejoining conference doesn&amp;rsquo;t work (&amp;ldquo;conferenceJoined&amp;rdquo; never fires, additional Jitsi events never reached)
&lt;ul&gt;
&lt;li&gt;bug in JitsiConferenceClient.leave - never resets this.roomName, so skips joining on .join RESOLVED&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;about-this-series&#34;&gt;About this series&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;Back in mid-December I started an ambitious project to create a custom platform for a virtual birthday party in February. I kept notes on my progress, both for personal reference and to turn into a series of blog posts. It quickly became apparent that I did not have time to both &lt;em&gt;do the project&lt;/em&gt; and &lt;em&gt;blog about the project&lt;/em&gt;. I have retroactively decided to post my raw notes as a dev log.&lt;/p&gt;
&lt;/blockquote&gt;</description>
     </item>
   
     <item>
       <title>Virtual Party Space Devlog #8: Bug stomping</title>
       <link>https://blog.fabrefact.ca/posts/virtual-party-space-devlog-8/</link>
       <pubDate>Wed, 13 Jan 2021 23:59:00 -0700</pubDate>
       
       <guid>https://blog.fabrefact.ca/posts/virtual-party-space-devlog-8/</guid>
       <description>&lt;p&gt;Today I identify a bunch of bugs in getting my rough POC working.&lt;/p&gt;
&lt;h1 id=&#34;log&#34;&gt;Log&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;error was because Calla is built for ESNext and I was building for ES5, updating webpack config to ESNext worked (for now?)&lt;/li&gt;
&lt;li&gt;Bug: this.connection null when trying to join room
&lt;ul&gt;
&lt;li&gt;missing call to calla.connect()&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;spatial audio works better, not janking with movement now
&lt;ul&gt;
&lt;li&gt;need to figure out how to adjust volume/dropoff&lt;/li&gt;
&lt;li&gt;clip volume of 1 appears to be ok&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Bug: clip audio still plays even after conference left, manually remove during &amp;ldquo;conference left&amp;rdquo; event handler&lt;/li&gt;
&lt;li&gt;Bug: connection is not getting destroyed/recreated properly&lt;/li&gt;
&lt;li&gt;Bug: username not set&lt;/li&gt;
&lt;li&gt;Bug: username tag not unloading (probably something to do with how username set/fact that id is all internal to Calla now)&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;about-this-series&#34;&gt;About this series&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;Back in mid-December I started an ambitious project to create a custom platform for a virtual birthday party in February. I kept notes on my progress, both for personal reference and to turn into a series of blog posts. It quickly became apparent that I did not have time to both &lt;em&gt;do the project&lt;/em&gt; and &lt;em&gt;blog about the project&lt;/em&gt;. I have retroactively decided to post my raw notes as a dev log.&lt;/p&gt;
&lt;/blockquote&gt;</description>
     </item>
   
     <item>
       <title>Virtual Party Space Devlog #7: Upgrade pain</title>
       <link>https://blog.fabrefact.ca/posts/virtual-party-space-devlog-7/</link>
       <pubDate>Tue, 12 Jan 2021 23:59:00 -0700</pubDate>
       
       <guid>https://blog.fabrefact.ca/posts/virtual-party-space-devlog-7/</guid>
       <description>&lt;p&gt;Today I struggle with a new, completely backwards-incompatible version of Calla.&lt;/p&gt;
&lt;h1 id=&#34;log&#34;&gt;Log&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;First tried copying in new Calla library, tons of errors&lt;/li&gt;
&lt;li&gt;Downloaded newer version with updated build script, but still took a long time to figure out how I&amp;rsquo;m supposed to use it&lt;/li&gt;
&lt;li&gt;Loaded as npm library using &lt;code&gt;file:..&lt;/code&gt; syntax
&lt;ul&gt;
&lt;li&gt;Had to add &lt;code&gt;allowUmdGlobalAccess&lt;/code&gt; and &lt;code&gt;resolveJsonModule&lt;/code&gt; to tsconfig to avoid errors&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Changed integration to use new syntax, but still guessing on what some of the analogues are
&lt;ul&gt;
&lt;li&gt;public AudioManager interface actually makes adding clips easier&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Error breaks JS on load in website though&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;about-this-series&#34;&gt;About this series&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;Back in mid-December I started an ambitious project to create a custom platform for a virtual birthday party in February. I kept notes on my progress, both for personal reference and to turn into a series of blog posts. It quickly became apparent that I did not have time to both &lt;em&gt;do the project&lt;/em&gt; and &lt;em&gt;blog about the project&lt;/em&gt;. I have retroactively decided to post my raw notes as a dev log.&lt;/p&gt;
&lt;/blockquote&gt;</description>
     </item>
   
     <item>
       <title>Virtual Party Space Devlog #6: Putting it all together</title>
       <link>https://blog.fabrefact.ca/posts/virtual-party-space-devlog-6/</link>
       <pubDate>Sun, 10 Jan 2021 23:59:00 -0700</pubDate>
       
       <guid>https://blog.fabrefact.ca/posts/virtual-party-space-devlog-6/</guid>
       <description>&lt;p&gt;Today I start combining my game interface with the audio spatialization library.&lt;/p&gt;
&lt;h1 id=&#34;log&#34;&gt;Log&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;imported Calla implementation into Phaser implementation
&lt;ul&gt;
&lt;li&gt;using tile position as &amp;ldquo;pose&amp;rdquo; since Calla uses metres as spatialization&lt;/li&gt;
&lt;li&gt;this worked surprisingly easily&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;tried to add an audio source to map to test - this is harder than expected!
&lt;ul&gt;
&lt;li&gt;Calla relies entirely on Jitsi for adding user audio, thought would have to create extra Jitsi users for every static audio source
&lt;ul&gt;
&lt;li&gt;this would be a huge pain and require customizing Jitsi&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;upon reflection, may be easier to just add dummy sources to Calla&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;adding static audio sources to Calla
&lt;ul&gt;
&lt;li&gt;AudioManager has support for &amp;ldquo;clips&amp;rdquo; - creates an audio HTML element from audio file path
&lt;ul&gt;
&lt;li&gt;how to set location?
&lt;ul&gt;
&lt;li&gt;AudioManager.setClipPosition&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;No API for accessing this in CallaClient
&lt;ul&gt;
&lt;li&gt;add createClip function&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;looks like Calla has been updated recently to be able to be loaded as library
&lt;ul&gt;
&lt;li&gt;using typescript now?&lt;/li&gt;
&lt;li&gt;still doesn&amp;rsquo;t look finished/easily loadable&lt;/li&gt;
&lt;li&gt;Docker documentation for Calla does include the setup issue I had, sorta (4 months old, so my bad for not figuring that out)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;uigame&#34;&gt;UI/Game&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;playing with map offsets in Tiled&lt;/li&gt;
&lt;li&gt;figured out how to make an animation for fountain in Tiled, but it doesn&amp;rsquo;t work in Phaser. Need to do via Phaser animation or &lt;a href=&#34;https://github.com/nkholski/phaser-animated-tiles&#34;&gt;use plugin&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;learned how to add ipad as video source in OBS
&lt;ul&gt;
&lt;li&gt;need to use cable&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;can do isometric depth with min(x,y) + modifier
&lt;ul&gt;
&lt;li&gt;roofs always higher layer&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;downloaded &lt;a href=&#34;https://soundbible.com/1435-Water-Fountain-Noise.html&#34;&gt;free fountain sound&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;about-this-series&#34;&gt;About this series&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;Back in mid-December I started an ambitious project to create a custom platform for a virtual birthday party in February. I kept notes on my progress, both for personal reference and to turn into a series of blog posts. It quickly became apparent that I did not have time to both &lt;em&gt;do the project&lt;/em&gt; and &lt;em&gt;blog about the project&lt;/em&gt;. I have retroactively decided to post my raw notes as a dev log.&lt;/p&gt;
&lt;/blockquote&gt;</description>
     </item>
   
     <item>
       <title>Virtual Party Space Devlog #5: Config issues</title>
       <link>https://blog.fabrefact.ca/posts/virtual-party-space-devlog-5/</link>
       <pubDate>Sat, 09 Jan 2021 23:59:00 -0700</pubDate>
       
       <guid>https://blog.fabrefact.ca/posts/virtual-party-space-devlog-5/</guid>
       <description>&lt;p&gt;Today I muddled through configuration issues to get things working properly in a dev environment&lt;/p&gt;
&lt;h1 id=&#34;log&#34;&gt;Log&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;forgot to update last times I worked on this&lt;/li&gt;
&lt;li&gt;Got jammed up on a Calla &amp;ldquo;bug&amp;rdquo; and spent several sessions just trying to figure out why I couldn&amp;rsquo;t successfully create a Jitsi connection
&lt;ul&gt;
&lt;li&gt;problem is that &amp;ldquo;hosts&amp;rdquo; passed to &lt;code&gt;JitsiMeetJS.JitsiConnection&lt;/code&gt; must match configured hostnames in docker container, which is not explained in Calla documentation&lt;/li&gt;
&lt;li&gt;&amp;ldquo;serviceUrl&amp;rdquo; needs to be publicly-available hostname for http-bind, giving the illusion that it was working&lt;/li&gt;
&lt;li&gt;Calla docs say to use same value for JITSI_HOST and JVB_HOST without giving any indication of how those values are actually used by Jitsi&lt;/li&gt;
&lt;li&gt;this took me way, way too long to figure out&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;fixed CORS issue in testing by learning how to &lt;a href=&#34;https://webpack.js.org/configuration/dev-server/#devserverproxy&#34;&gt;proxy requests via webpack server&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;learning how to do this the &amp;ldquo;proper&amp;rdquo; way instead of the janked up dev environment way is going to be tricky&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;about-this-series&#34;&gt;About this series&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;Back in mid-December I started an ambitious project to create a custom platform for a virtual birthday party in February. I kept notes on my progress, both for personal reference and to turn into a series of blog posts. It quickly became apparent that I did not have time to both &lt;em&gt;do the project&lt;/em&gt; and &lt;em&gt;blog about the project&lt;/em&gt;. I have retroactively decided to post my raw notes as a dev log.&lt;/p&gt;
&lt;/blockquote&gt;</description>
     </item>
   
     <item>
       <title>Virtual Party Space Devlog #4: Audio spatialization</title>
       <link>https://blog.fabrefact.ca/posts/virtual-party-space-devlog-4/</link>
       <pubDate>Tue, 22 Dec 2020 23:59:00 -0700</pubDate>
       
       <guid>https://blog.fabrefact.ca/posts/virtual-party-space-devlog-4/</guid>
       <description>&lt;p&gt;Today I tried to make audio spatialization work, and looked into Jitsi features and how to properly render isometric tiles.&lt;/p&gt;
&lt;h1 id=&#34;log&#34;&gt;Log&lt;/h1&gt;
&lt;h3 id=&#34;calla&#34;&gt;Calla&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Calla as a library seems to be more usable than expected
&lt;ul&gt;
&lt;li&gt;Tutorial exists in sub-project&amp;rsquo;s &lt;code&gt;doc&lt;/code&gt; directory&lt;/li&gt;
&lt;li&gt;&amp;ldquo;broken&amp;rdquo; UI is the minimal client implementation from tutorial&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;notes-for-calla-implementation&#34;&gt;Notes for Calla implementation&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;spatializer distance is in &amp;ldquo;meters&amp;rdquo;, may need to play around with math on this?&lt;/li&gt;
&lt;li&gt;uses &lt;code&gt;omnitone&lt;/code&gt; preferred, but has a number of different spatializers, depending what browser supports&lt;/li&gt;
&lt;li&gt;library handles interpolation of audio over time and assumes you&amp;rsquo;re using that for avatar movement, need to think how to integrate with sprite movement&lt;/li&gt;
&lt;li&gt;audio sources set their own max distance (so players can control how far people can hear them, but not vice versa)
&lt;ul&gt;
&lt;li&gt;except Calla user messages don&amp;rsquo;t include audio properties? So this would be a universal setting for all users in their world&lt;/li&gt;
&lt;li&gt;can add mute flag to user array to allow people to mute individuals?&lt;/li&gt;
&lt;li&gt;environmental sound can be set to whatever I like&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;jitsi&#34;&gt;Jitsi&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Jitsi includes text chat, need to examine that for use/abuse cases&lt;/li&gt;
&lt;li&gt;Jitsi Videobridge last-N feature may be hackable to only show nearest-N video streams
&lt;ul&gt;
&lt;li&gt;locations are sent peer-to-peer by Calla, so clients would have to request specific list of streams with each update&lt;/li&gt;
&lt;li&gt;all audio streams will always be sent, most likely&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;uigame&#34;&gt;UI/Game&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;How to do appropriate layering in isometric view?&lt;/li&gt;
&lt;li&gt;Phaser isometric sample seems to use at minimum a different layer for every grid-Y, and change sprite layer based on y value&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;about-this-series&#34;&gt;About this series&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;Back in mid-December I started an ambitious project to create a custom platform for a virtual birthday party in February. I kept notes on my progress, both for personal reference and to turn into a series of blog posts. It quickly became apparent that I did not have time to both &lt;em&gt;do the project&lt;/em&gt; and &lt;em&gt;blog about the project&lt;/em&gt;. I have retroactively decided to post my raw notes as a dev log.&lt;/p&gt;
&lt;/blockquote&gt;</description>
     </item>
   
     <item>
       <title>Virtual Party Space Devlog #3: Making web games</title>
       <link>https://blog.fabrefact.ca/posts/virtual-party-space-devlog-3/</link>
       <pubDate>Mon, 21 Dec 2020 23:59:00 -0700</pubDate>
       
       <guid>https://blog.fabrefact.ca/posts/virtual-party-space-devlog-3/</guid>
       <description>&lt;p&gt;Today I started making a 2D game to use as a front-end, and learned how to make isometric tile maps.&lt;/p&gt;
&lt;h1 id=&#34;log&#34;&gt;Log&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://www.mapeditor.org/&#34;&gt;Tiled map editor&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;Not too difficult for basic usage but glad I had a tutorial.&lt;/li&gt;
&lt;li&gt;Most of the options are not that obvious&lt;/li&gt;
&lt;li&gt;Still not really sure about collision boxes?&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://medium.com/swlh/grid-based-movement-in-a-top-down-2d-rpg-with-phaser-3-e3a3486eb2fd&#34;&gt;Phaser tutorial&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Assets are larger than they appear, 256px
&lt;ul&gt;
&lt;li&gt;bought &lt;a href=&#34;https://graphicriver.net/&#34;&gt;more asset packs&lt;/a&gt; for fancier maps (creator name: eldamien)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Trial-and-errored to the approximate right angle rotation for isometric movement, but it made the tile math all wonky
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://clintbellanger.net/articles/isometric_math/&#34;&gt;isometric math tutorial&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Do I really need tile-based movement?
&lt;ul&gt;
&lt;li&gt;might make audio math simpler but could also go by pixel distance?&lt;/li&gt;
&lt;li&gt;what about for private rooms/determinine how many people fit in limited spaces?&lt;/li&gt;
&lt;li&gt;character collision?&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;about-this-series&#34;&gt;About this series&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;Back in mid-December I started an ambitious project to create a custom platform for a virtual birthday party in February. I kept notes on my progress, both for personal reference and to turn into a series of blog posts. It quickly became apparent that I did not have time to both &lt;em&gt;do the project&lt;/em&gt; and &lt;em&gt;blog about the project&lt;/em&gt;. I have retroactively decided to post my raw notes as a dev log.&lt;/p&gt;
&lt;/blockquote&gt;</description>
     </item>
   
 </channel>
</rss>
