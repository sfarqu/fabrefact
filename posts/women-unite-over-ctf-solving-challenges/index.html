<!doctype html>

<html lang="en-us">

<head>
  <title>Women Unite Over CTF - Solving Challenges - Fabrefact</title>
  <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="description" content="a blog by Sara Farquharson" />
<meta name="author" content="Sara Farquharson" /><meta property="og:title" content="Women Unite Over CTF - Solving Challenges" />
<meta property="og:description" content="The winner of the Women Unite Over CTF, Jaime Lightfoot, quickly posted writeups about how she solved the challenges. These posts (networking challenges, reverse engineering, and Linux exploitation) are excellent for the same reasons I enjoyed the event in general: my main barrier to entry is not knowing what tools to use or what to look for." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://blog.fabrefact.ca/posts/women-unite-over-ctf-solving-challenges/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-11-04T16:04:02-08:00" />
<meta property="article:modified_time" content="2019-11-04T16:04:02-08:00" /><meta property="og:site_name" content="Fabrefact" />


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Women Unite Over CTF - Solving Challenges"/>
<meta name="twitter:description" content="The winner of the Women Unite Over CTF, Jaime Lightfoot, quickly posted writeups about how she solved the challenges. These posts (networking challenges, reverse engineering, and Linux exploitation) are excellent for the same reasons I enjoyed the event in general: my main barrier to entry is not knowing what tools to use or what to look for."/>

<meta name="generator" content="Hugo 0.81.0" />
    

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" integrity="sha256-l85OmPOjvil/SOvVt3HnSSjzF1TUMyT9eV0c2BzEGzU=" crossorigin="anonymous" />
  <link rel="stylesheet" href="https://blog.fabrefact.ca/fontawesome/css/all.min.css" />
  
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Slab|Ruda" />
  
  
  <link rel="stylesheet" type="text/css" href="/css/styles.css" /><link rel='stylesheet' href='https://blog.fabrefact.ca/css/custom.css'></head>

<body>
  <div id="container">
    <header>
      <h1>
                <a href="/">Fabrefact</a>
            </h1>

      <ul id="social-media">
             <li>
               <a href="https://github.com/sfarqu" title="GitHub">
               <i class="fab fa-github fa-lg"></i>
               </a>
             </li>
             <li>
               <a href="https://twitter.com/fabrefact" title="Twitter">
               <i class="fab fa-twitter fa-lg"></i>
               </a>
             </li>
      </ul>
      
      <p><em>a blog by Sara Farquharson</em></p>
      
    </header>

    
<nav>
    <ul>
        
        <li>
            <a class="" href="/posts/">
                <i class="fa-li fa  fa-lg"></i><span>Archive</span>
            </a>
        </li>
        
    </ul>
</nav>


    <main>




<article>

    <h1>Women Unite Over CTF - Solving Challenges</h1>

    
      <aside>
    <ul>
        <li>
            <time class="post-date" datetime="2019-11-04T16:04:02-08:00">Nov 4, 2019</time>
        </li>
        
        <li>
            Categories:
            <em>
                
                    
                    <a href="/categories/events">events</a>
                
                    , 
                    <a href="/categories/blog">blog</a>
                
            </em>
        </li>
        

        
        <li>
            <em>
                
                    
                    <a href="/tags/security">#security</a>
                
                    , 
                    <a href="/tags/ctf">#ctf</a>
                
            </em>
        </li>
        

        <li>7 minutes read</li>
    </ul>
</aside>

    

    


    <p>The winner of the Women Unite Over CTF, Jaime Lightfoot, quickly posted writeups about how she solved the challenges. These posts (<a href="https://jaimelightfoot.com/blog/women-unite-over-ctf-networking-challenges/">networking challenges</a>, <a href="https://jaimelightfoot.com/blog/women-unite-over-ctf-reverse-engineering-challenges/">reverse engineering</a>, and <a href="https://jaimelightfoot.com/blog/women-unite-over-ctf-linux-exploitation/">Linux exploitation</a>) are excellent for the same reasons I enjoyed the event in general: my main barrier to entry is not knowing what tools to use or what to look for.</p>
<p>I thought of including details of my own problem-solving approach in my <a href="/fabrefact/posts/wtf-is-a-ctf/">last post</a>, but I didn&rsquo;t have the forethought to take any screenshots. Since I was working in a provided VM, I don&rsquo;t even have any of the challenge files or tools on my own computer. However, I ended up solving exactly the same problems as two of Jaime&rsquo;s posts, so here I will simply talk about how my solutions differed from hers.</p>
<h1 id="networking-challenges">Networking challenges</h1>
<p>(See <a href="https://jaimelightfoot.com/blog/women-unite-over-ctf-networking-challenges/">Women Unite Over CTF - Networking Challenges</a> for Jaime&rsquo;s solutions, with screenshots.)</p>
<p>I opened up the networking challenges because technical difficulties delayed the start of the reverse engineering walkthroughs. I hovered over random icons in the Kali Linux VM, hoping that one of them was a tool for looking at network information. Luckily Wireshark was prominently placed!</p>
<p>I have literally never used Wireshark before, but it&rsquo;s the tool everyone talks about so it seemed an obvious choice. I solved these pretty slowly, but now that I know a little bit about Wireshark I expect to be faster next time.</p>
<h3 id="level-1-helpfulwine">level 1: helpfulwine</h3>
<p>As soon as I opened the file and selected a packet at random, the flag showed up in the bottom pane. My first flag! It took a bit of trial and error to figure out how to copy it—I eventually had to paste whatever I copied into a text editor in order to strip out all the extraneous content before pasting the flag into the form.</p>
<h3 id="level-2-rhetoricalairplane">level 2: rhetoricalairplane</h3>
<p>Jaime used <code>frame contains &quot;flag&quot;</code> in all of these to narrow down which packet contained the flag text, but I just clicked around randomly until I found it.</p>
<h3 id="level-3-numberlesslove">level 3: numberlesslove</h3>
<p>Again I just clicked around randomly looking for something called &ldquo;flag&rdquo;. Used the exact same strategy as Jaime here, which is heartening!</p>
<h3 id="level-4-warmsong">level 4: warmsong</h3>
<p>This is where I slowed down a lot, because I didn&rsquo;t know about the Export Objects function. I could see from the headers that it was a .docx so I assumed I had to extract the doc and open it&hellip;but I didn&rsquo;t know how. I tried looking at a bunch of different packets, right clicking on things, copying and pasting the bytes into a file&hellip;eventually I realized this must be a common problem and started looking for an export function.</p>
<p>Once I successfully save the .doc, my next challenge was how to open a Word document in an unfamiliar OS. I searched for something like &ldquo;how to open word doc linux command line&rdquo; and learned <code>lowriter flag.doc</code>.</p>
<h3 id="level-5-savoryhill">level 5: savoryhill</h3>
<p>Now that I knew about Export Objects function this went quickly. Export object as PNG, do a quick search to figure out what kind of program on Linux can open PNGs. The first search result suggested that <code>xdg-open</code> is a good way to open a file in its default program.</p>
<h1 id="reverse-engineering-challenges">Reverse engineering challenges</h1>
<p>(See <a href="https://jaimelightfoot.com/blog/women-unite-over-ctf-reverse-engineering-challenges/">Women Unite Over CTF – Reverse Engineering Challenges</a> for Jaime&rsquo;s solutions, with screenshots.)</p>
<p>The reverse engineering challenges had walkthroughs on the live stream, which is good because I definitely wouldn&rsquo;t have gotten anywhere without them!</p>
<h3 id="level-1-calculateerratic">level 1: calculateerratic</h3>
<p>I followed Nada&rsquo;s walkthrough and used Binary Ninja, using the <code>View &gt; Strings</code> option Jaime mentions in the next problem. Nada talked about the <code>strings</code> command but I never tried it.</p>
<h3 id="level-2-dustyabandon">level 2: dustyabandon</h3>
<p>The walkthroughs were also available as PDFs shared in the event Slack, so I started working a little ahead of the livestream. I spent a bunch of time in Binary Ninja, clicking on different views and trying to remember everything I ever knew about assembly.</p>
<p>I found the password-constructing subfunction (<code>sub_40100</code> highlighted in Jaime&rsquo;s writeup), and the PDF said something about using <code>R</code> in Binary Ninja to switch to character representations, but I wasn&rsquo;t able to make heads nor tails of this code and didn&rsquo;t know what I was supposed to be switching. I waited for Nada&rsquo;s livestream to catch up. It seemed obvious as soon as Nada pointed out the hex codes!</p>
<p>Definitely don&rsquo;t recognize hex values in the ASCII range off the top of my head, but maybe that&rsquo;s a skill to acquire?</p>
<h3 id="level-3-etherealshop">level 3: etherealshop</h3>
<p>By now I expected a program with a similar design to the first two and opened it up in Binary Ninja to verify the same pattern of password comparison. I kind of went down a rabbit hole trying to understand what assembly was doing and tuned into the livestream to get back on track.</p>
<p>This is where my solution differed from Jaime&rsquo;s by a lot—the documentation suggested switching to dynamic analysis so I opened up the program in Ollydbg. (Sorry no screenshots for this part.) I used an address I had found in Binary Ninja to get to the right section of code, but mostly poked around trying to understand the interface until Nada started talking about setting a breakpoint.</p>
<p>Breakpoints I understand! The step-in/step-over commands are similar to every IDE debugger I&rsquo;ve used, so it didn&rsquo;t take long to step through until the flag showed up in a register.</p>
<h3 id="level-4-expertquestion">level 4: expertquestion</h3>
<p>By now the contest was well over, and the Escalate platform was actually quite responsive, so I decided to tackle one more difficult problem. This one didn&rsquo;t have a walkthrough!</p>
<p>I started the same process I&rsquo;d gone through with all the other RE problems. Like Jaime, I found that the password encryption now had three functions doing mysterious things to the encrypted password that looked very hairy to decipher in static analysis. Unlike Jaime, I did not have any insights over hard-coded bytes and encryption methods. Instead I opened up Ollydbg for some dynamic analysis.</p>
<p>This part was a bit of a slog. Unlike level 3, the password didn&rsquo;t show up conveniently in the little window that seemed to hold the current instruction. When I stepped through the comparison of the user-entered text to the password, it instead went straight to the &ldquo;You are not leet enough&rdquo; message. I went back further and started stepping through the entire decryption function.</p>
<p>Throughout this I was trying to piece together more about how Ollydbg works. There&rsquo;s a large pane in the top left that contains your program, and one on the top right that shows the contents of all the registers (as well as some other stuff that I never understood.) In the bottom right shows the stack—you can scroll down through it to see all the pointers in the call stack from other functions.</p>
<p>That left the pane in the lower left as being I assume the heap? While stepping through the decryption process I eventually saw stuff starting to change here. At first it appeared to be random gibberish, but it still looked like a clue.</p>
<p>The decryption has a bunch of loops, and I learned how to recognize what a loop looks like in assembly and skip to the next instruction if nothing relevant seems to happen inside. This was not the most efficient method, but I was worried if I skipped too far ahead I would miss the flag again!</p>
<p>After far too long of this, the flag unscrambled itself in the pane I decided was the heap. Victory!</p>
<h1 id="conclusion">Conclusion</h1>
<p>Jaime&rsquo;s walkthroughs were a great refresher and a beginner-friendly introduction to some new techniques. I look forward to reading more from her, and maybe—just maybe—I&rsquo;ll remember to take some screenshots of my own next time.</p>

</article>


<section class="post-nav">
    <ul>
        
        <li>
            <a href="https://blog.fabrefact.ca/posts/wtf-is-a-ctf/"><i class="fa fa-chevron-circle-left"></i> WTF is a CTF? A beginner&#39;s adventure</a>
        </li>
        
        
        <li>
            <a href="https://blog.fabrefact.ca/posts/review-doing-good-better/">Review: Doing Good Better <i class="fa fa-chevron-circle-right"></i> </a>
        </li>
        
    </ul>
</section>
  
    
    
  





</main>
    <footer>
        <h6>© 2019 Sara Farquharson |
            Rendered by <a href="https://gohugo.io" title="Hugo">Hugo</a> |
            <a href="https://blog.fabrefact.ca/index.xml">Subscribe </a></h6>
    </footer>
</div>
<script src="/js/scripts.js"></script>

</body>

</html>

